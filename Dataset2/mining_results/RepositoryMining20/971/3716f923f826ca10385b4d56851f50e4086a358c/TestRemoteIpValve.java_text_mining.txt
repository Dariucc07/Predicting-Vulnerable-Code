{'package': 1, 'org': 14, 'apache': 14, 'catalina': 3, 'valves': 1, 'import': 8, 'java': 4, 'io': 1, 'IOException': 2, 'util': 3, 'ArrayList': 4, 'Arrays': 4, 'List': 5, 'javax': 1, 'servlet': 1, 'ServletException': 2, 'junit': 1, 'framework': 1, 'TestCase': 2, 'connector': 2, 'Request': 25, 'Response': 2, 'public': 25, 'class': 3, 'TestRemoteIpValve': 1, 'extends': 3, 'static': 2, 'RemoteAddrAndHostTrackerValve': 23, 'ValveBase': 1, 'private': 6, 'String': 100, 'remoteAddr': 3, 'remoteHost': 3, 'scheme': 7, 'boolean': 10, 'secure': 3, 'int': 10, 'serverPort': 3, 'getRemoteAddr': 24, 'return': 6, 'getRemoteHost': 24, 'getScheme': 10, 'getServerPort': 10, 'isSecure': 10, 'Override': 2, 'void': 19, 'invoke': 12, 'request': 143, 'response': 1, 'throws': 12, 'this': 5, 'MockRequest': 12, 'setAttribute': 1, 'name': 1, 'Object': 1, 'value': 14, 'NOOP': 1, 'testing': 1, 'testListToCommaDelimitedString': 1, 'elements': 4, 'asList': 3, 'actual': 15, 'RemoteIpValve': 27, 'listToCommaDelimitedString': 3, 'assertEquals': 78, 'testListToCommaDelimitedStringEmptyList': 1, 'new': 49, 'testCommaDelimitedListToStringArrayNullList': 1, 'null': 13, 'testInvokeAllowedRemoteAddrWithNullRemoteIpHeader': 1, 'Exception': 11, 'remoteIpValve': 69, 'setInternalProxies': 7, 'setTrustedProxies': 7, 'setRemoteIpHeader': 11, 'x': 90, 'forwarded': 90, 'for': 46, 'setProxiesHeader': 7, 'by': 25, 'remoteAddrAndHostTrackerValve': 56, 'setNext': 11, 'setCoyoteRequest': 11, 'coyote': 11, 'setRemoteAddr': 11, 'setRemoteHost': 11, 'remote': 13, 'host': 18, 'original': 13, 'actualXForwardedFor': 22, 'getHeader': 22, 'assertNull': 17, 'actualXForwardedBy': 22, 'actualRemoteAddr': 22, 'actualRemoteHost': 22, 'actualPostInvokeRemoteAddr': 22, 'actualPostInvokeRemoteHost': 22, 'testInvokeAllProxiesAreTrusted': 1, 'getCoyoteRequest': 18, 'getMimeHeaders': 14, 'addValue': 14, 'setString': 18, 'trusted': 10, 'testInvokeAllProxiesAreTrustedOrInternal': 1, 'testInvokeAllProxiesAreInternal': 1, 'internal': 9, 'testInvokeAllProxiesAreTrustedAndRemoteAddrMatchRegexp': 1, 'another': 1, 'proxy': 16, 'testInvokeXforwardedProtoSaysHttpsForIncomingHttpRequest': 1, 'setProtocolHeader': 4, 'proto': 20, 'setSecure': 4, 'false': 6, 'setServerPort': 4, 'non': 4, 'actualScheme': 8, 'actualServerPort': 8, 'actualSecure': 8, 'true': 6, 'actualPostInvokeSecure': 8, 'actualPostInvokeServerPort': 8, 'actualPostInvokeScheme': 8, 'testInvokeXforwardedProtoIsNullForIncomingHttpRequest': 1, 'testInvokeXforwardedProtoSaysHttpForIncomingHttpsRequest': 1, 'testInvokeXforwardedProtoIsNullForIncomingHttpsRequest': 1, 'testInvokeNotAllowedRemoteAddr': 1, 'not': 6, 'allowed': 6, 'testInvokeUntrustedProxyInTheChain': 1, 'untrusted': 5, 'ip': 2, 'testCommaDelimitedListToStringArray': 1, 'commaDelimitedListToStringArray': 2, 'expected': 8, 'assertArrayEquals': 3, 'testCommaDelimitedListToStringArrayMixedSpaceChars': 1, 't': 1, 'if': 1, 'assertNotNull': 1, 'length': 2, 'e': 3, 'addAll': 2, 'a': 4, 'entry': 2, 'assertTrue': 2, 'remove': 1, 'isEmpty': 1}