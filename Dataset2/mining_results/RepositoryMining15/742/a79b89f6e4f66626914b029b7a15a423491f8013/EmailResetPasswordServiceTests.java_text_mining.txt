{'package': 1, 'org': 37, 'cloudfoundry': 11, 'identity': 11, 'uaa': 19, 'login': 2, 'import': 40, 'java': 4, 'sql': 1, 'Timestamp': 12, 'util': 4, 'Arrays': 7, 'Collection': 2, 'Map': 2, 'static': 8, 'hamcrest': 2, 'Matchers': 8, 'containsString': 9, 'junit': 6, 'Assert': 4, 'assertThat': 11, 'mockito': 8, 'any': 5, 'anyString': 7, 'contains': 6, 'eq': 21, 'Mockito': 8, 'mock': 5, 'when': 16, 'codestore': 2, 'ExpiringCode': 8, 'ExpiringCodeStore': 3, 'error': 1, 'UaaException': 2, 'test': 7, 'ThymeleafConfig': 2, 'scim': 3, 'ScimUser': 16, 'ScimUserProvisioning': 3, 'endpoints': 1, 'PasswordResetEndpoints': 3, 'UaaUrlUtils': 3, 'zone': 4, 'IdentityZoneHolder': 4, 'MultitenancyFixture': 3, 'codehaus': 1, 'jackson': 1, 'map': 1, 'ObjectMapper': 2, 'After': 2, 'Before': 2, 'Test': 8, 'runner': 1, 'RunWith': 2, 'ArgumentCaptor': 7, 'springframework': 8, 'beans': 2, 'factory': 2, 'annotation': 2, 'Autowired': 2, 'Qualifier': 2, 'security': 4, 'core': 4, 'Authentication': 2, 'GrantedAuthority': 2, 'context': 4, 'SecurityContext': 3, 'SecurityContextHolder': 4, 'ContextConfiguration': 2, 'thymeleaf': 1, 'SpringTemplateEngine': 2, 'class': 15, 'classes': 1, 'public': 17, 'EmailResetPasswordServiceTests': 1, 'private': 6, 'EmailResetPasswordService': 2, 'emailResetPasswordService': 9, 'MessageService': 1, 'messageService': 8, 'templateEngine': 2, 'passwordResetEndpoints': 3, 'codeStore': 10, 'scimUserProvisioning': 10, 'uaaUrlUtils': 3, 'void': 10, 'setUp': 1, 'throws': 9, 'Exception': 8, 'clearContext': 2, 'EmailService': 1, 'new': 29, 'http': 3, 'example': 27, 'com': 29, 'tearDown': 1, 'clear': 1, 'testForgotPasswordWhenAResetCodeIsReturnedByTheUaa': 1, 'user': 53, 'id': 20, 'setPrimaryEmail': 5, 'query': 6, 'thenReturn': 15, 'asList': 6, 'generateCode': 4, 'System': 7, 'currentTimeMillis': 7, 'forgotPassword': 5, 'verify': 4, 'sendMessage': 4, 'MessageType': 4, 'a': 4, 'href': 2, 'code': 4, 'amp': 2, 'email': 2, 'Reset': 2, 'password': 2, 'testResetPasswordInOtherZone': 1, 'set': 2, 'identityZone': 2, 'String': 14, 'captor': 9, 'forClass': 3, 'capture': 3, 'emailContent': 8, 'getValue': 3, 'format': 2, 's': 4, 'you': 3, 'br': 3, 'n': 3, 'testForgotPasswordWhenConflictIsReturnedByTheUaa': 1, 'retrieveCode': 3, 'service': 2, 'requests': 2, 'testForgotPasswordInOtherZoneWhenConflictIsReturnedByTheUaa': 1, 'emailBody': 3, 'testForgotPasswordWhenTheCodeIsDenied': 1, 'verifyZeroInteractions': 1, 'testResetPassword': 1, 'usermans': 4, 'retrieve': 1, 'securityContext': 3, 'getAuthentication': 1, 'Override': 7, 'extends': 1, 'getAuthorities': 1, 'return': 6, 'null': 5, 'Object': 3, 'getCredentials': 1, 'getDetails': 1, 'getPrincipal': 1, 'boolean': 2, 'isAuthenticated': 2, 'false': 1, 'setAuthenticated': 1, 'IllegalArgumentException': 1, 'getName': 1, 'setContext': 1, 'userInfo': 3, 'resetPassword': 2, 'hasEntry': 2, 'expected': 1, 'testResetPasswordWhenTheCodeIsDenied': 1}