{'package': 1, 'org': 59, 'cloudfoundry': 6, 'identity': 6, 'uaa': 6, 'oauth': 9, 'import': 67, 'client': 8, 'ClientConstants': 2, 'token': 6, 'CompositeAccessToken': 5, 'TokenConstants': 3, 'util': 12, 'UaaHttpRequestUtils': 2, 'springframework': 53, 'http': 3, 'HttpStatus': 2, 'ResponseEntity': 2, 'security': 35, 'access': 1, 'AccessDeniedException': 2, 'authentication': 5, 'InsufficientAuthenticationException': 3, 'core': 2, 'Authentication': 18, 'AuthenticationException': 2, 'common': 12, 'exceptions': 10, 'BadClientCredentialsException': 2, 'ClientAuthenticationException': 2, 'InvalidClientException': 3, 'InvalidRequestException': 4, 'RedirectMismatchException': 5, 'UnapprovedClientAuthenticationException': 2, 'UnauthorizedClientException': 2, 'UnsupportedResponseTypeException': 3, 'UserDeniedAuthorizationException': 2, 'provider': 18, 'AuthorizationRequest': 15, 'ClientDetails': 3, 'ClientRegistrationException': 2, 'NoSuchClientException': 2, 'TokenRequest': 3, 'approval': 4, 'DefaultUserApprovalHandler': 2, 'UserApprovalHandler': 3, 'code': 7, 'AuthorizationCodeServices': 3, 'InMemoryAuthorizationCodeServices': 2, 'endpoint': 3, 'AbstractEndpoint': 2, 'DefaultRedirectResolver': 2, 'RedirectResolver': 3, 'implicit': 2, 'ImplicitTokenRequest': 3, 'request': 8, 'stereotype': 1, 'Controller': 2, 'StringUtils': 3, 'web': 15, 'HttpSessionRequiredException': 3, 'bind': 8, 'annotation': 5, 'ExceptionHandler': 4, 'RequestMapping': 3, 'RequestMethod': 2, 'RequestParam': 3, 'SessionAttributes': 2, 'support': 3, 'DefaultSessionAttributeStore': 2, 'SessionAttributeStore': 3, 'SessionStatus': 3, 'context': 1, 'ServletWebRequest': 6, 'servlet': 4, 'ModelAndView': 20, 'View': 3, 'view': 1, 'RedirectView': 8, 'UriComponentsBuilder': 7, 'UriUtils': 2, 'javax': 1, 'HttpServletRequest': 3, 'java': 9, 'io': 1, 'UnsupportedEncodingException': 2, 'Principal': 3, 'Arrays': 2, 'Collections': 2, 'Date': 2, 'HashMap': 3, 'List': 2, 'Map': 13, 'Set': 4, 'static': 2, 'public': 16, 'class': 4, 'UaaAuthorizationEndpoint': 1, 'extends': 1, 'private': 22, 'authorizationCodeServices': 5, 'new': 47, 'redirectResolver': 6, 'userApprovalHandler': 9, 'sessionAttributeStore': 5, 'String': 60, 'userApprovalPage': 6, 'forward': 2, 'errorPage': 6, 'error': 6, 'Object': 9, 'implicitLock': 2, 'HybridTokenGranterForAuthorizationCode': 3, 'hybridTokenGranterForAuthCode': 5, 'getHybridTokenGranterForAuthCode': 2, 'return': 35, 'void': 9, 'setHybridTokenGranterForAuthCode': 1, 'this': 9, 'setSessionAttributeStore': 1, 'setErrorPage': 1, 'final': 1, 'asList': 1, 'value': 9, 'authorize': 3, 'model': 15, 'parameters': 8, 'sessionStatus': 7, 'principal': 16, 'clientId': 6, 'try': 11, 'get': 9, 'getClientDetailsService': 2, 'loadClientByClientId': 2, 'catch': 10, 'x': 5, 'throw': 17, 'getMessage': 4, 'first': 1, 'map': 8, 'created': 1, 'authorizationRequest': 73, 'createAuthorizationRequest': 3, 'DisallowedIdpException': 1, 'switchIdp': 2, 'responseTypes': 16, 'getResponseTypes': 8, 'grantType': 10, 'getGrantType': 3, 'if': 40, 'containsAll': 1, 'types': 1, 'getClientId': 2, 'null': 23, 'redirectUriParameter': 3, 'getRequestParameters': 3, 'resolvedRedirect': 5, 'resolveRedirect': 2, 'rme': 1, 'hasText': 2, 'boolean': 5, 'isAuthenticated': 4, 'instanceof': 6, 'equals': 2, 'completed': 1, 'setRedirectUri': 2, 'ignoring': 1, 'manager': 1, 'validateScope': 1, 'default': 2, 'here': 1, 'accordingly': 1, 'checkForPreApproval': 1, 'TODO': 1, 'necessary': 1, 'approved': 4, 'isApproved': 4, 'setApproved': 2, 'done': 1, 'contains': 14, 'modelAndView': 6, 'getImplicitGrantOrHybridResponse': 3, 'getAuthorizationCodeResponse': 3, 'use': 1, 'session': 2, 'put': 8, 'getUserApprovalPageResponse': 2, 'RuntimeException': 1, 'e': 23, 'setComplete': 5, 'additionalInfo': 5, 'getAdditionalInformation': 4, 'clientDisplayName': 3, 'queryString': 2, 'paramsToQueryString': 1, 'getParameterMap': 2, 'redirectUri': 2, 'getRequestURL': 1, 'account': 1, 'login': 2, 'UNAUTHORIZED': 1, 'method': 1, 'POST': 1, 'params': 1, 'approveOrDeny': 1, 'approvalParameters': 2, 'setApprovalParameters': 1, 'updateAfterApproval': 1, 'getRedirectUri': 5, 'provided': 1, 'getUnsuccessfulRedirect': 5, 'false': 13, 'true': 12, 'getView': 1, 'finally': 1, 'protected': 1, 'size': 1, 'else': 4, 'user': 2, 'logger': 4, 'debug': 1, 'page': 1, 'putAll': 1, 'getUserApprovalRequest': 1, 'accessToken': 14, 'tokenRequest': 5, 'createTokenRequest': 1, 'getAccessTokenForImplicitGrantOrHybrid': 2, 'type': 1, 'appendAccessToken': 2, 'throws': 6, 'atomic': 1, 'it': 1, 'synchronized': 1, 'switch': 1, 'case': 2, 'getTokenGranter': 1, 'grant': 2, 'authUser': 4, 'getSuccessfulRedirect': 2, 'generateCode': 3, 'fragment': 6, 'requestedRedirect': 4, 'StringBuilder': 4, 'url': 12, 'append': 21, 'encode': 17, 'getTokenType': 1, 'getValue': 2, 'getIdTokenValue': 1, 'state': 8, 'getState': 6, 'expiration': 3, 'getExpiration': 1, 'long': 1, 'getTime': 1, 'System': 1, 'currentTimeMillis': 1, 'originalScope': 3, 'SCOPE': 2, 'parseParameterList': 1, 'getScope': 2, 'formatParameterList': 1, 'additionalInformation': 3, 'for': 3, 'key': 6, 'keySet': 2, 'toString': 6, 'builder': 5, 'fromUriString': 3, 'existingFragment': 6, 'build': 4, 'getFragment': 1, 'query': 2, 'even': 1, 'one': 1, 'toUriString': 3, 'combinedAuth': 2, 'createAuthorizationCode': 1, 'addAdditionalInformation': 1, 'URLEncoder': 1, 'UTF': 2, 'encodeQueryParam': 1, 'IllegalArgumentException': 1, 'authorizationCode': 3, 'IllegalStateException': 1, 'scope': 1, 'template': 8, 'queryParam': 2, 'failure': 7, 'sad': 1, 'URI': 1, 'values': 11, 'Entry': 1, 'entrySet': 1, 'getKey': 1, 'setUserApprovalPage': 1, 'setAuthorizationCodeServices': 1, 'setRedirectResolver': 1, 'setUserApprovalHandler': 1, 'SuppressWarnings': 1, 'setImplicitGrantService': 1, 'ImplicitGrantService': 1, 'implicitGrantService': 1, 'handleClientRegistrationException': 1, 'Exception': 7, 'webRequest': 12, 'info': 3, 'handleException': 4, 'getSummary': 1, 'handleHttpSessionRequiredException': 1, 'translate': 6, 'getExceptionTranslator': 1, 'getResponse': 1, 'setStatus': 1, 'getStatusCode': 1, 'getBody': 3, 'getAuthorizationRequestForError': 2, 'requestedRedirectParam': 2, 'redirect': 2, 'ex': 1, 'way': 1, 'response': 1, 'singletonMap': 1, 'retrieveAttribute': 1, 'length': 1}