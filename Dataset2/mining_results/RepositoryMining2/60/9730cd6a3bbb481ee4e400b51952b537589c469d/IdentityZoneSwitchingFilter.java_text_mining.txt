{'package': 1, 'org': 13, 'cloudfoundry': 4, 'identity': 4, 'uaa': 4, 'zone': 2, 'import': 23, 'authentication': 5, 'UaaAuthentication': 4, 'UaaAuthenticationDetails': 2, 'util': 8, 'UaaStringUtils': 4, 'springframework': 9, 'beans': 1, 'factory': 1, 'annotation': 1, 'Autowired': 2, 'dao': 6, 'EmptyResultDataAccessException': 2, 'security': 5, 'core': 2, 'Authentication': 2, 'context': 1, 'SecurityContextHolder': 4, 'provider': 3, 'expression': 1, 'StringUtils': 3, 'web': 1, 'filter': 1, 'OncePerRequestFilter': 2, 'javax': 4, 'servlet': 4, 'FilterChain': 2, 'ServletException': 2, 'http': 2, 'HttpServletRequest': 3, 'HttpServletResponse': 4, 'java': 7, 'io': 1, 'IOException': 2, 'Arrays': 3, 'Collection': 2, 'Collections': 3, 'HashSet': 3, 'List': 3, 'Set': 3, 'public': 8, 'class': 1, 'IdentityZoneSwitchingFilter': 2, 'extends': 1, 'IdentityZoneProvisioning': 2, 'super': 1, 'this': 1, 'private': 1, 'final': 7, 'static': 6, 'String': 23, 'HEADER': 2, 'X': 1, 'Identity': 1, 'Zone': 1, 'Id': 1, 'zones': 3, 'zoneSwitchScopes': 3, 'unmodifiableList': 2, 'asList': 2, 'read': 3, 'clients': 3, 'admin': 2, 'write': 1, 'idps': 1, 'zoneScopestoNotStripPrefix': 2, 'protected': 5, 'boolean': 4, 'isAuthorizedToSwitchToIdentityZone': 2, 'identityZoneId': 16, 'getContext': 3, 'getAuthentication': 2, 'hasScope': 2, 'hasAnyScope': 1, 'getZoneSwitchingScopes': 3, 'isUaa': 3, 'IdentityZoneHolder': 4, 'isTokenAuth': 2, 'instanceof': 1, 'return': 8, 'void': 2, 'stripScopesFromAuthentication': 2, 'servletRequest': 2, 'oa': 7, 'Object': 1, 'oaDetails': 2, 'getDetails': 1, 'request': 17, 'requestAuthorities': 2, 'getStringsFromAuthorities': 1, 'getAuthorities': 1, 'clientScopes': 4, 'new': 7, 'clientAuthorities': 3, 'for': 3, 's': 12, 'scope': 5, 'stripPrefix': 2, 'if': 9, 'getScope': 1, 'contains': 2, 'add': 2, 'getRequestParameters': 1, 'getClientId': 1, 'getAuthoritiesFromStrings': 2, 'isApproved': 1, 'getResourceIds': 1, 'getRedirectUri': 1, 'getResponseTypes': 1, 'getExtensions': 1, 'userAuthentication': 5, 'getUserAuthentication': 1, 'null': 4, 'getPrincipal': 1, 'true': 1, 'setDetails': 1, 'setAuthentication': 1, 'hasText': 2, 'id': 2, 'replace': 5, 'equals': 1, 'startsWith': 1, 'substring': 1, 'length': 2, 'result': 4, 'size': 1, 'int': 1, 'i': 5, 'get': 2, 'Override': 1, 'doFilterInternal': 1, 'response': 5, 'filterChain': 3, 'throws': 1, 'getHeader': 1, 'sendError': 2, 'IdentityZone': 2, 'originalIdentityZone': 2, 'try': 2, 'identityZone': 4, 'retrieve': 1, 'catch': 3, 'ZoneDoesNotExistsException': 1, 'ex': 4, 'Exception': 1, 'throw': 1, 'set': 2, 'doFilter': 2, 'finally': 1, 'else': 1}