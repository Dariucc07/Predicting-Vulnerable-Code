{'package': 1, 'org': 45, 'cloudfoundry': 14, 'identity': 14, 'uaa': 18, 'util': 11, 'import': 49, 'oauth': 9, 'token': 9, 'RevocableToken': 2, 'RevocableTokenProvisioning': 6, 'user': 5, 'InMemoryUaaUserDatabase': 2, 'MockUaaUserDatabase': 3, 'UaaUser': 2, 'UaaUserDatabase': 4, 'zone': 1, 'IdentityZoneHolder': 4, 'junit': 7, 'Before': 2, 'Rule': 2, 'Test': 23, 'rules': 1, 'ExpectedException': 3, 'mockito': 8, 'Mockito': 8, 'springframework': 9, 'dao': 1, 'EmptyResultDataAccessException': 3, 'security': 8, 'core': 1, 'authority': 1, 'SimpleGrantedAuthority': 3, 'jwt': 4, 'crypto': 3, 'sign': 3, 'MacSigner': 4, 'SignatureVerifier': 2, 'Signer': 2, 'common': 2, 'exceptions': 2, 'InsufficientScopeException': 2, 'InvalidTokenException': 15, 'provider': 2, 'client': 3, 'BaseClientDetails': 4, 'InMemoryClientDetailsService': 7, 'java': 8, 'time': 1, 'Instant': 5, 'Arrays': 8, 'Collection': 9, 'Collections': 11, 'HashMap': 2, 'Map': 4, 'stream': 2, 'Collectors': 2, 'static': 23, 'ClientConstants': 1, 'ClaimConstants': 2, 'EMAIL': 2, 'TokenValidation': 23, 'validate': 24, 'UaaMapUtils': 2, 'entry': 22, 'map': 4, 'hamcrest': 5, 'Matchers': 4, 'containsInAnyOrder': 7, 'empty': 5, 'hasItem': 15, 'instanceOf': 15, 'Assert': 3, 'assertFalse': 18, 'assertThat': 19, 'assertTrue': 8, 'mock': 4, 'spy': 2, 'times': 4, 'verify': 4, 'verifyZeroInteractions': 2, 'when': 4, 'MockitoHamcrest': 1, 'argThat': 7, 'public': 27, 'class': 19, 'TokenValidationTest': 1, 'final': 5, 'String': 22, 'private': 14, 'verifier': 4, 'new': 23, 'oneSecondAfterTheTokenExpires': 2, 'ofEpochSecond': 2, 'oneSecondBeforeTheTokenExpires': 4, 'Object': 3, 'header': 4, 'content': 10, 'signer': 5, 'revocableTokenProvisioning': 12, 'clientDetailsService': 11, 'userDb': 9, 'uaaUser': 8, 'uaaClient': 13, 'uaaUserGroups': 8, 'expectedException': 3, 'none': 1, 'void': 23, 'setup': 1, 'asList': 7, 'acme': 7, 'dev': 7, 'marissa': 3, 'test': 3, 'http': 5, 'localhost': 4, 'true': 1, 'addAdditionalInformation': 5, 'setClientDetailsStore': 3, 'singletonMap': 2, 'retrieve': 3, 'get': 3, 'getId': 3, 'thenReturn': 1, 'setValue': 1, 'UaaTokenUtils': 2, 'constructToken': 2, 'u': 4, 'withUsername': 2, 'withId': 2, 'withEmail': 2, 'withAuthorities': 2, 'singletonList': 5, 'retrieveUserById': 5, 'getAuthorities': 1, 'a': 6, 'getAuthority': 1, 'collect': 1, 'toList': 1, 'getToken': 25, 'return': 2, 'excludedClaims': 2, 'this': 2, 'null': 4, 'for': 1, 'key': 2, 'remove': 2, 'throws': 9, 'Exception': 9, 'validation': 73, 'checkClientAndUser': 5, 'checkRequiredUserGroups': 3, 'toArray': 3, 'reset': 1, 'throwIfInvalid': 2, 'isValid': 24, 'add': 1, 'group': 1, 'missing': 1, 'from': 1, 'expect': 1, 'expectMessage': 1, 'criteria': 1, 'validateToken': 1, 'checkSignature': 3, 'checkIssuer': 4, 'checkClient': 4, 'clientId': 8, 'loadClientByClientId': 4, 'checkExpiry': 4, 'checkUser': 4, 'uid': 8, 'checkScopesInclude': 3, 'checkScopesWithin': 3, 'another': 2, 'scope': 6, 'checkRevocationSignature': 5, 'checkAudience': 4, 'checkRevocableTokenStore': 4, 'getValidationErrors': 18, 'tokenSignedWithDifferentKey': 1, 'invalidJwt': 1, 'invalid': 1, 'tokenWithInvalidIssuer': 1, 'wrong': 1, 'issuer': 1, 'emptyBodyJwt': 1, 'decoding': 1, 'check': 2, 'clone': 2, 'expiredToken': 1, 'nonExistentUser': 1, 'emptySet': 1, 'userHadScopeRevoked': 1, 'different': 4, 'tokenHasInsufficientScope': 1, 'tokenContainsRevokedScope': 1, 'nonExistentClient': 1, 'emptyMap': 1, 'clientHasScopeRevoked': 1, 'clientRevocationHashChanged': 1, 'New': 3, 'Hash': 3, 'incorrectAudience': 1, 'emptyAudience': 1, 'tokenIsRevoked': 1, 'thenThrow': 2, 'nonRevocableToken': 1}