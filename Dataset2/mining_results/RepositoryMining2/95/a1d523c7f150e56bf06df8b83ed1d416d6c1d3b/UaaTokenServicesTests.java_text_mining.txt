{'package': 1, 'org': 110, 'cloudfoundry': 60, 'identity': 60, 'uaa': 65, 'oauth': 48, 'import': 126, 'apache': 1, 'commons': 1, 'collections': 1, 'map': 4, 'HashedMap': 2, 'approval': 7, 'Approval': 32, 'ApprovalStatus': 29, 'audit': 3, 'AuditEvent': 2, 'AuditEventType': 2, 'event': 5, 'TokenIssuedEvent': 3, 'authentication': 91, 'UaaPrincipal': 5, 'constants': 1, 'OriginKeys': 4, 'jwt': 1, 'Jwt': 9, 'token': 49, 'ClaimConstants': 10, 'CompositeAccessToken': 16, 'RevocableToken': 21, 'RevocableTokenProvisioning': 2, 'TokenConstants': 13, 'matchers': 18, 'user': 7, 'UaaUser': 4, 'UaaUserPrototype': 2, 'util': 18, 'JsonUtils': 4, 'TokenValidation': 2, 'zone': 10, 'ClientServicesExtension': 2, 'IdentityZone': 8, 'IdentityZoneConfiguration': 4, 'IdentityZoneHolder': 64, 'junit': 15, 'After': 2, 'Assert': 16, 'Before': 2, 'Rule': 3, 'Test': 71, 'rules': 1, 'ExpectedException': 5, 'runner': 1, 'RunWith': 2, 'runners': 1, 'Parameterized': 3, 'mockito': 7, 'ArgumentCaptor': 11, 'springframework': 17, 'security': 16, 'InternalAuthenticationServiceException': 2, 'core': 3, 'Authentication': 39, 'authority': 1, 'AuthorityUtils': 2, 'common': 8, 'exceptions': 4, 'InsufficientScopeException': 2, 'InvalidGrantException': 2, 'InvalidScopeException': 2, 'InvalidTokenException': 20, 'provider': 5, 'AuthorizationRequest': 127, 'ClientDetails': 2, 'TokenRequest': 7, 'client': 5, 'BaseClientDetails': 11, 'ReflectionUtils': 2, 'java': 17, 'lang': 1, 'reflect': 1, 'Field': 2, 'net': 1, 'URISyntaxException': 5, 'Arrays': 22, 'Calendar': 66, 'Collection': 2, 'Collections': 13, 'Date': 3, 'HashMap': 65, 'HashSet': 67, 'LinkedHashMap': 2, 'List': 4, 'Map': 72, 'Set': 3, 'function': 1, 'Consumer': 3, 'static': 63, 'emptyMap': 3, 'singleton': 8, 'TokenTestSupport': 15, 'IMPLICIT': 3, 'OPENID': 11, 'PASSWORD': 5, 'PROFILE': 2, 'ROLES': 3, 'UaaTokenServices': 4, 'ClientConstants': 1, 'ClientDetailsModification': 1, 'SECRET': 2, 'OPAQUE': 13, 'TokenFormat': 8, 'JWT': 8, 'audience': 6, 'cid': 3, 'clientId': 9, 'email': 3, 'expiry': 4, 'issuedAt': 4, 'issuerUri': 27, 'jwtId': 4, 'origin': 3, 'revocationSignature': 3, 'scope': 19, 'subject': 4, 'userId': 47, 'username': 11, 'validFor': 30, 'zoneId': 2, 'UaaAuthority': 1, 'hamcrest': 10, 'CoreMatchers': 4, 'equalTo': 2, 'is': 117, 'not': 14, 'nullValue': 19, 'MatcherAssert': 1, 'assertThat': 104, 'Matchers': 2, 'containsInAnyOrder': 2, 'AllOf': 1, 'allOf': 4, 'number': 2, 'OrderingComparison': 2, 'greaterThan': 9, 'lessThanOrEqualTo': 8, 'text': 1, 'IsEmptyString': 1, 'isEmptyString': 4, 'assertEquals': 46, 'assertFalse': 5, 'assertNotEquals': 2, 'assertNotNull': 9, 'assertNull': 7, 'assertTrue': 16, 'fail': 4, 'ArgumentMatchers': 1, 'eq': 2, 'anyString': 8, 'Mockito': 4, 'mock': 3, 'never': 2, 'times': 7, 'verify': 8, 'class': 38, 'public': 79, 'UaaTokenServicesTests': 2, 'private': 19, 'TestTokenEnhancer': 3, 'tokenEnhancer': 4, 'expectedEx': 13, 'none': 2, 'String': 168, 'thousandScopes': 4, 'persistToken': 10, 'expiration': 8, 'tokenSupport': 379, 'tokenProvisioning': 13, 'expiresAt': 57, 'getInstance': 21, 'updatedAt': 31, 'enhancer': 2, 'testname': 2, 'this': 38, 'Parameters': 1, 'name': 4, 'index': 1, 'Object': 4, 'data': 1, 'return': 10, 'asList': 21, 'new': 285, 'null': 19, 'tokenServices': 110, 'void': 81, 'setUp': 1, 'throws': 25, 'Exception': 15, 'for': 5, 'int': 2, 'i': 4, 'add': 24, 'valueOf': 1, 'value': 9, 'System': 2, 'currentTimeMillis': 1, 'setScope': 29, 'setExpiration': 1, 'getUaaTokenServices': 1, 'getTokenProvisioning': 1, 'teardown': 1, 'revocableTokens': 1, 'remove': 1, 'clear': 4, 'get': 102, 'getConfig': 10, 'getTokenPolicy': 9, 'setJwtRevocable': 2, 'false': 7, 'setRefreshTokenFormat': 4, 'getStringValue': 9, 'result': 8, 'persistRevocableToken': 5, 'refresh': 8, 'true': 15, 'rt': 24, 'forClass': 5, 'create': 5, 'capture': 5, 'getAllValues': 14, 'size': 3, 'TokenType': 5, 'getResponseType': 5, 'getFormat': 3, 'getValue': 70, 'getRefreshToken': 67, 'setRefreshTokenUnique': 2, 'deleteRefreshTokensForClientAndUserId': 2, 'getId': 53, 'refreshToken': 50, 'currentZoneId': 2, 'setClientDetailsService': 1, 'try': 4, 'afterPropertiesSet': 1, 'catch': 3, 'IllegalArgumentException': 3, 'x': 4, 'getMessage': 3, 'contains': 14, 'expected': 17, 'setIssuer': 2, 'field': 3, 'getDeclaredField': 1, 'setAccessible': 1, 'setField': 1, 'getTokenEndpoint': 1, 'defaultClient': 19, 'setAutoApproveScopes': 10, 'authorizationRequest': 219, 'requestedAuthScopes': 76, 'setResponseTypes': 5, 'setResourceIds': 58, 'resourceIds': 63, 'azParameters': 136, 'getRequestParameters': 61, 'put': 75, 'setRequestParameters': 62, 'userAuthentication': 74, 'defaultUserAuthentication': 41, 'opaqueTokenRequired': 1, 'testNullRefreshTokenString': 1, 'refreshAccessToken': 24, 'testInvalidGrantType': 1, 'ar': 2, 'requestFactory': 20, 'createTokenRequest': 20, 'dsdada': 1, 'testInvalidRefreshToken': 1, 'expect': 8, 'expectMessage': 8, 'setActiveKeyId': 4, 'performPasswordGrant': 7, 'testCreateAccessTokenForAClient': 1, 'clientScopes': 4, 'accessToken': 198, 'createAccessToken': 45, 'assertCommonClientAccessTokenProperties': 3, 'accessTokenValidity': 4, 'validateExternalAttributes': 6, 'assertCommonEventProperties': 13, 'expectedJson': 2, 'refreshTokenValue': 13, 'length': 9, 'assertCommonUserRefreshTokenProperties': 10, 'refreshTokenRequest': 6, 'getRefreshTokenRequest': 6, 'tokens': 5, 's': 6, 'refreshedAccessToken': 35, 'assertCommonUserAccessTokenProperties': 18, 'parameters': 3, 'protected': 6, 'tokenFormat': 2, 'testCreateOpaqueAccessTokenForAClient': 1, 'instanceof': 3, 'testCreateAccessTokenForAClientInAnotherIdentityZone': 1, 'subdomain': 16, 'test': 6, 'identityZone': 18, 'getIdentityZone': 4, 'setConfig': 3, 'readValue': 3, 'tokenPolicy': 9, 'refreshTokenValidity': 3, 'copyClients': 3, 'set': 3, 'http': 4, 'localhost': 4, 'publisher': 3, 'getEventCount': 2, 'setId': 1, 'setSubdomain': 1, 'setName': 1, 'setDescription': 1, 'tastier': 1, 'testCreateAccessTokenAuthcodeGrant': 1, 'validateAccessAndRefreshToken': 5, 'testCreateAccessTokenOnlyForClientWithoutRefreshToken': 1, 'validateAccessTokenOnly': 3, 'testCreateAccessTokenAuthcodeGrantSwitchedPrimaryKey': 1, 'originalPrimaryKeyId': 2, 'getActiveKeyId': 1, 'finally': 1, 'testCreateAccessTokenPasswordGrant': 1, 'loadAuthentication': 13, 'setExcludedClaims': 2, 'AUTHORITIES': 1, 'EMAIL': 2, 'getUserAuthentication': 4, 'addAdditionalInformation': 1, 'admin': 1, 'criteria': 1, 'setClientSecret': 3, 'getClientSecret': 1, 'e': 2, 'testCreateRevocableAccessTokenPasswordGrant': 1, 'buildJsonString': 11, 'extendedAttributes': 3, 'getAdditionalInformation': 2, 'if': 2, 'else': 1, 'testCreateAccessTokenRefreshGrant': 1, 'InterruptedException': 7, 'requestParameters': 2, 'refreshAuthorizationRequest': 71, 'refreshAzParameters': 54, 'MILLISECOND': 23, 'approvalStore': 31, 'addApproval': 28, 'setUserId': 28, 'setClientId': 28, 'readScope': 17, 'setExpiresAt': 28, 'getTime': 44, 'setStatus': 28, 'APPROVED': 25, 'setLastUpdatedAt': 16, 'writeScope': 12, 'testCreateAccessTokenRefreshGrantAllScopesAutoApproved': 1, 'clientDetails': 22, 'cloneClient': 8, 'clientDetailsService': 9, 'setClientDetailsStore': 9, 'singletonMap': 8, 'testCreateAccessTokenRefreshGrantSomeScopesAutoApprovedDowngradedRequest': 1, 'testCreateAccessTokenRefreshGrantSomeScopesAutoApproved': 1, 'testCreateAccessTokenRefreshGrantNoScopesAutoApprovedIncompleteApprovals': 1, 'testCreateAccessTokenRefreshGrantAllScopesAutoApprovedButApprovalDenied': 1, 'DENIED': 3, 'refreshTokenNotCreatedIfGrantTypeRestricted': 1, 'setRestrictRefreshGrant': 4, 'testCreateAccessTokenImplicitGrant': 1, 'idTokenJwt': 18, 'getIdToken': 9, 'getClaims': 14, 'amr': 2, 'ext': 2, 'rba': 2, 'mfa': 2, 'ACR': 1, 'values': 1, 'roles': 1, 'defaultUser': 3, 'getGivenName': 1, 'getFamilyName': 1, 'getPhoneNumber': 1, 'scopes': 3, 'testCreateAccessWithNonExistingScopes': 1, 'scopesThatDontExist': 4, 'getUaa': 1, 'list': 3, 'StringBuffer': 2, 'buf': 7, 'count': 2, 'append': 5, 'toString': 2, 'testCreateAccessTokenAuthcodeGrantNarrowerScopes': 1, 'reducedScopeAuthorizationRequest': 16, 'reducedScopeAuthentication': 1, 'reducedScopeAccessToken': 3, 'testCreateAccessTokenAuthcodeGrantExpandedScopes': 1, 'expandedScopeAuthorizationRequest': 6, 'expandedScopes': 1, 'expandedScopeAuthentication': 1, 'testChangedExpiryForTokens': 1, 'setAccessTokenValiditySeconds': 2, 'setRefreshTokenValiditySeconds': 2, 'TokenRevokedException': 1, 'testUserUpdatedAfterRefreshTokenIssued': 1, 'userDatabase': 4, 'retrieveUserByName': 1, 'UAA': 3, 'newUser': 2, 'withId': 1, 'withUsername': 1, 'getUsername': 1, 'withPassword': 1, 'withEmail': 1, 'getEmail': 1, 'withAuthorities': 1, 'getAuthorities': 4, 'updateUser': 1, 'testRefreshTokenExpiry': 1, 'testRefreshTokenAfterApprovalsRevoked': 1, 'getApprovals': 1, 'revokeApproval': 2, 'testRefreshTokenAfterApprovalsExpired': 1, 'testRefreshTokenAfterApprovalsDenied': 1, 'testRefreshTokenAfterApprovalsMissing': 1, 'refreshAccessTokenWithGrantTypeRestricted': 1, 'testReadAccessToken': 1, 'readAccessToken': 6, 'excludedClaims': 2, 'testReadAccessTokenForDeletedUserId': 1, 'testLoadAuthenticationForAUser': 1, 'loadedAuthentication': 18, 'getName': 5, 'uaaPrincipal': 6, 'getPrincipal': 7, 'getDetails': 3, 'userAuth': 8, 'isAuthenticated': 2, 'ignore': 4, 'non': 1, 'existent': 1, 'ID': 2, 'getClientId': 1, 'Void': 2, 'setup': 4, 'keys': 3, 'setKeys': 1, 'setTokenPolicy': 1, 'composite': 7, 'getIdTokenValue': 2, 'accept': 1, 'validateToken': 4, 'accessTokenValue': 2, 'retrieve': 4, 'accessTokenClaims': 2, 'REVOCABLE': 2, 'refreshTokenClaims': 2, 'params': 4, 'newAccessToken': 2, 'out': 1, 'println': 1, 'compositeToken': 4, 'expectedException': 5, 'provided': 2, 'testLoadAuthenticationForAClient': 1, 'match': 1, 'commaSeparatedStringToAuthorityList': 1, 'toArray': 1, 'testLoadAuthenticationWithAnExpiredToken': 1, 'shortExpiryClient': 3, 'Thread': 1, 'sleep': 1, 'testCreateAccessTokenAuthcodeGrantAdditionalAuthorizationAttributes': 1, 'domain': 2, 'azMap': 4, 'SuppressWarnings': 3, 'expectedPrincipalId': 2, 'expectedData': 2, 'getLatestEvent': 1, 'getSource': 1, 'mockAuthentication': 1, 'getAuthentication': 1, 'auditEvent': 4, 'getAuditEvent': 1, 'getPrincipalId': 1, 'getData': 1, 'getType': 1}