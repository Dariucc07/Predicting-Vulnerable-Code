{'package': 1, 'org': 9, 'apache': 9, 'hadoop': 8, 'hive': 7, 'llap': 4, 'cache': 3, 'import': 27, 'java': 17, 'util': 6, 'concurrent': 4, 'atomic': 3, 'AtomicBoolean': 2, 'AtomicLong': 6, 'com': 2, 'google': 2, 'common': 3, 'annotations': 1, 'VisibleForTesting': 7, 'base': 2, 'Preconditions': 2, 'io': 7, 'File': 3, 'IOException': 3, 'RandomAccessFile': 3, 'nio': 8, 'ByteBuffer': 6, 'channels': 1, 'FileChannel': 1, 'MapMode': 2, 'file': 6, 'FileSystems': 2, 'Files': 4, 'Path': 3, 'attribute': 3, 'FileAttribute': 2, 'PosixFilePermission': 2, 'PosixFilePermissions': 3, 'Arrays': 5, 'Set': 2, 'AtomicInteger': 5, 'locks': 1, 'ReentrantLock': 3, 'commons': 1, 'IOUtils': 2, 'conf': 16, 'Configuration': 3, 'encoded': 2, 'MemoryBuffer': 16, 'HiveConf': 12, 'ConfVars': 16, 'api': 1, 'impl': 1, 'LlapIoImpl': 19, 'metrics': 9, 'LlapDaemonCacheMetrics': 4, 'ql': 1, 'orc': 1, 'StoppableAllocator': 2, 'public': 43, 'final': 31, 'class': 5, 'BuddyAllocator': 3, 'implements': 1, 'EvictionAwareAllocator': 1, 'BuddyAllocatorMXBean': 1, 'LlapIoDebugDump': 1, 'private': 91, 'Arena': 14, 'arenas': 20, 'allocatedArenas': 6, 'new': 38, 'MemoryManager': 3, 'memoryManager': 10, 'static': 32, 'long': 50, 'minutes': 1, 'lastLog': 3, 'int': 315, 'maxArenas': 4, 'minAllocation': 14, 'maxAllocation': 18, 'arenaSize': 18, 'maxSize': 10, 'boolean': 26, 'isDirect': 7, 'isMapped': 5, 'cacheDir': 5, 'tests': 1, 'enableDefragShortcut': 3, 'true': 20, 'oomLogging': 3, 'array': 2, 'boundary': 1, 'allocation': 2, 'space': 2, 'grief': 1, 'headroom': 1, 'caches': 1, 'float': 1, 'RWX': 2, 'asFileAttribute': 1, 'fromString': 1, 'rwx': 1, 'defragCounters': 8, 'doUseFreeListDiscard': 3, 'doUseBruteDiscard': 4, 'assertsEnabled': 14, 'areAssertsEnabled': 2, 'arrays': 1, 'size': 35, 'this': 18, 'objects': 1, 'ThreadLocal': 2, 'DiscardContext': 16, 'threadCtx': 2, 'protected': 1, 'initialValue': 1, 'return': 101, 'mm': 2, 'getBoolVar': 3, 'getSizeVar': 4, 'getIntVar': 1, 'getMaxTotalMemorySize': 2, 'getVar': 2, 'false': 13, 'assert': 15, 'if': 126, 'throw': 12, 'RuntimeException': 6, 'operation': 1, 'varname': 5, 'required': 1, 'memory': 7, 'isDirectVal': 2, 'isMappedVal': 2, 'minAllocVal': 2, 'maxAllocVal': 2, 'arenaCount': 38, 'maxSizeVal': 17, 'defragHeadroom': 8, 'String': 14, 'mapPath': 2, 'discardMethod': 5, 'try': 16, 'path': 4, 'getDefault': 1, 'getPath': 1, 'exists': 1, 'createDirectory': 1, 'createTempDirectory': 1, 'catch': 6, 'ioe': 5, 'AssertionError': 3, 'else': 17, 'null': 61, 'validateAndDetermineArenaSize': 2, 'validateAndDetermineMaxSize': 2, 'updateMaxSize': 1, 'determineMaxMmSize': 2, 'Integer': 12, 'numberOfLeadingZeros': 5, 'Long': 1, 'for': 24, 'i': 66, 'firstArena': 2, 'init': 5, 'set': 5, 'length': 32, 'incrAllocatedArena': 2, 'isBoth': 3, 'equalsIgnoreCase': 3, 'maxMmSize': 3, 'maxHeadroom': 2, 'Math': 8, 'floor': 1, 'min': 7, 'LOG': 18, 'info': 11, 'oldMaxSize': 2, 'warn': 3, 'arenaSizeVal': 10, 'math': 1, 'overflow': 1, 'max': 3, 'isInfoEnabled': 1, 'buffers': 17, 'toString': 6, 'minName': 4, 'maxName': 3, 'bytes': 2, 'sizes': 1, 'total': 5, 'bitCount': 2, 'two': 2, 'oldArenaSize': 2, 'Override': 14, 'void': 53, 'allocateMultiple': 5, 'dest': 53, 'throws': 3, 'AllocatorOutOfMemoryException': 4, 'BufferObjectFactory': 2, 'factory': 5, 'isStopped': 2, 'freeListIx': 123, 'determineFreeListForAllocation': 2, 'allocationSize': 10, 'async': 1, 'one': 3, 'reserveMemory': 1, 'continue': 8, 'Note': 6, 'only': 1, 'createUnallocated': 3, 'create': 1, 'correct': 1, 'sized': 6, 'them': 1, 'get': 6, 'allocated': 5, 'threadId': 4, 's': 1, 'threads': 2, 'Thread': 11, 'currentThread': 10, 'getId': 9, 'destAllocIx': 21, 'allocateFast': 4, 'somewhere': 2, 'However': 1, 'locking': 1, 'checking': 1, 'areas': 1, 'Or': 1, 'arena': 37, 'each': 1, 'available': 1, 'freelist': 1, 'lists': 3, 'nothing': 2, 'overlap': 1, 'cross': 1, 'thread': 2, 'examine': 1, 'or': 2, 'code': 1, 'retry': 1, 'time': 5, 'attempt': 6, 'isFailed': 3, 'memoryForceReleased': 5, 'discardFailed': 3, 'while': 18, 'blocks': 10, 'startArenaIx': 16, 'allocateWithSplit': 6, 'yet': 1, 'rare': 1, 'allocateWithExpand': 4, 'force': 2, 'evict': 1, 'hasDiscardedAny': 5, 'ctx': 69, 'maxListSize': 2, 'requiredBlocks': 2, 'First': 2, 'discardBlocksBasedOnFreeLists': 2, 'memoryReleased': 5, 'resultCount': 7, 'allocateFromDiscardResult': 3, 'Then': 1, 'away': 1, 'resetResults': 3, 'discardBlocksBruteForce': 2, 'all': 1, 'deallocate': 8, 'Throwable': 1, 't': 1, 'allocate': 2, 'msg': 6, 'entire': 1, 'locked': 3, 'issue': 1, 'logOomErrorMessage': 2, 'finally': 11, 'releaseMemory': 4, 'released': 1, 'results': 6, 'victimHeaders': 14, 'victimCount': 18, 'baseHeaders': 7, 'baseCount': 8, 'remainingToFind': 10, 'abandonedHeaders': 8, 'abandonedCount': 6, 'headersPerOneReq': 2, 'reqCount': 6, 'maxVictimCount': 3, 'resetBetweenArenas': 4, 'cleaned': 1, 'addResult': 2, 'arenaIx': 77, 'freeHeaderIx': 11, 'makeIntPair': 26, 'addBaseHeader': 3, 'headerIx': 80, 'incrementAndGet': 2, 'merge': 3, 'mergeListIx': 9, 'buffer': 38, 'do': 6, 'reserveDiscardBlocksBasedOnFreeList': 2, 'discardFromCtxBasedOnFreeList': 2, 'needed': 2, 'getNextIx': 6, 'pseudo': 2, 'random': 2, 'search': 1, 'counter': 2, 'positionsPerArena': 2, 'above': 2, 'header': 39, 'startHeaderIx': 5, 'reserveDiscardBruteForce': 2, 'discardFromCtxBruteForce': 2, 'discardAllBuffersFromCtx': 3, 'headers': 37, 'baseIx': 8, 'baseHeaderIx': 3, 'minHeaderIx': 2, 'getBuddyHeaderIx': 6, 'finalizeDiscardResult': 3, 'newlyFreeHeaderIx': 6, 'maxHeaderIx': 2, 'checkHeader': 9, 'unsetHeaders': 2, 'CasLog': 43, 'Src': 29, 'that': 2, 'merged': 1, 'setHeaderNoBufAlloc': 6, 'victimIx': 4, 'victimHeaderIx': 15, 'here': 7, 'move': 2, 'LlapAllocatorBuffer': 23, 'buf': 29, 'byte': 17, 'assertBufferLooksValid': 5, 'freeListFromHeader': 10, 'memUsage': 7, 'getMemoryUsage': 3, 'Boolean': 2, 'result': 35, 'endDiscard': 1, 'cancelDiscard': 3, 'deallocation': 1, 'eviction': 1, 'destHeaders': 12, 'destIx': 35, 'destCount': 13, 'allocSize': 34, 'index': 6, 'newDestIx': 10, 'maxSplitFreeListIx': 6, 'discardResult': 3, 'getFirstInt': 8, 'allocateFromDiscard': 2, 'getSecondInt': 14, 'System': 7, 'nanoTime': 2, 'lastTime': 4, 'extra': 1, 'shouldLog': 3, 'compareAndSet': 3, 'error': 3, 'debugDumpForOomInternal': 2, 'debugDumpShort': 3, 'StringBuilder': 8, 'sb': 13, 'append': 30, 'nDefrag': 1, 'counters': 1, 'nAllocator': 1, 'state': 1, 'unallocCount': 3, 'fullCount': 3, 'totalFree': 3, 'nTotal': 1, 'n': 3, 'arenaToRelease': 6, 'invalidateAndRelease': 1, 'moved': 3, 'deallocateEvicted': 2, 'isInvalid': 1, 'releaseInvalidated': 1, 'memManager': 1, 'finishes': 1, 'Retrying': 1, 'more': 1, 'isDirectAlloc': 1, 'preallocateArenaBuffer': 2, 'rwf': 5, 'rf': 5, 'checkArgument': 1, 'createTempFile': 1, 'toFile': 1, 'setLength': 1, 'TODO': 2, 'RW': 1, 'copy': 1, 'on': 1, 'write': 1, 'YARN': 1, 'rwbuf': 2, 'getChannel': 1, 'map': 1, 'OutOfMemoryError': 3, 'getMessage': 2, 'mapping': 1, 'established': 1, 'it': 3, 'closeQuietly': 1, 'delete': 1, 'allocateDirect': 1, 'data': 24, 'allocations': 1, 'held': 1, 'block': 7, 'lookup': 1, 'FreeList': 17, 'freeLists': 17, 'oom': 2, 'correctly': 1, 'maxMinAllocs': 3, 'freeListCount': 3, 'maxMaxAllocs': 3, 'headerIndex': 22, 'headerStep': 8, 'listHead': 21, 'offset': 33, 'setHeaderFree': 3, 'CTOR': 2, 'putInt': 10, 'isLocked': 5, 'checkHeaderByte': 2, 'reserveResult': 6, 'reserveBlockContents': 3, 'reservedCount': 6, 'moveSize': 4, 'abandonOneHeaderBeingMoved': 3, 'freeList': 49, 'lock': 30, 'reserved': 4, 'headerToFreeIx': 11, 'list': 8, 'separately': 1, 'DOWN': 1, 'reserving': 1, 're': 1, 'trying': 1, 'failure': 1, 'prepareAbandonUnfinishedMoveAttempt': 2, 'nextFreeHeaderIx': 2, 'getNextFreeListItem': 7, 'offsetFromHeaderIndex': 14, 'removeBlockFromFreeList': 4, 'break': 2, 'unlock': 9, 'unlocking': 1, 'count': 14, 'startIx': 3, 'start': 5, 'newLen': 3, 'copyOf': 1, 'arraycopy': 3, 'victimsOffset': 3, 'isDiscard': 5, 'same': 2, 'buddy': 1, 'Double': 1, 'check': 2, 'prepareOneHeaderForMove': 3, 'startMoveOrDiscard': 2, 'logMove': 3, 'identityHashCode': 7, 'below': 1, 'sub': 4, 'detail': 1, 'stack': 4, 'elements': 1, 'stackSize': 5, 'so': 1, 'totalMoveSize': 3, 'tree': 6, 'levels': 1, 'next': 4, 'listLevel': 3, 'intermList': 1, 'sourceHeaderIx': 2, 'level': 5, 'in': 1, 'levelBuddyHeaderIx': 4, 'found': 1, 'races': 1, 'picture': 1, 'imagine': 1, 'aka': 1, 'sibling': 1, 'e': 3, 'actualBuddyListIx': 2, 'intermListIx': 4, 'src': 31, 'failWithLog': 6, 'addToFreeListWithMerge': 4, 'maxListIx': 2, 'discard': 1, 'changes': 1, 'right': 1, 'about': 1, 'there': 1, 'free': 1, 'either': 1, 'allocSizeFromFreeList': 6, 'initializeNewlyAllocated': 4, 'setHeaderAlloc': 4, 'alloc': 4, 'makeHeader': 5, 'logSet': 2, 'logSetFree': 2, 'logSetNb': 2, 'unsetHeader': 3, 'logUnset': 3, 'fromHeaderIx': 3, 'toHeaderIx': 3, 'fill': 1, 'debugDump': 2, 'nArena': 2, 'can': 2, 'nextHeaderIx': 9, 'isFree': 2, 'testDump': 3, 'allocState': 4, 'tryLock': 1, 'allocateFromFreeListUnderLock': 3, 'remaining': 8, 'target': 4, 'lucky': 1, 'smallest': 1, 'splitListIx': 5, 'splitting': 1, 'out': 2, 'splitWays': 4, 'lastSplitBlocksRemaining': 6, 'split': 2, 'lastSplitNextHeader': 6, 'remainder': 1, 'splitList': 5, 'origOffset': 3, 'ways': 1, 'toTake': 6, 'remains': 2, 'starts': 1, 'replaceListHeadUnderLock': 3, 'end': 1, 'head': 1, 'larger': 1, 'too': 1, 'abandoned': 1, 'newListIndex': 4, 'initialize': 1, 'setNewAllocLocation': 1, 'newHeadOffset': 2, 'backlink': 1, 'ix': 94, 'allocArenaCount': 3, 'thing': 1, 'recheck': 1, 'synchronized': 3, 'wait': 1, 'InterruptedException': 2, 'interrupt': 2, 'race': 1, 'again': 1, 'isCommited': 2, 'notifyAll': 1, 'current': 6, 'allocHeaderIx': 6, 'getPrevFreeListItem': 3, 'getInt': 2, 'isAfterMove': 2, 'byteBuffer': 2, 'pos': 2, 'position': 1, 'freeListFromAllocSize': 2, 'toDebugString': 4, 'DEALLOC': 2, 'bHeaderIx': 5, 'are': 1, 'addBlockToFreeListUnderLock': 2, 'logAddToList': 2, 'oldHeadOffset': 3, 'bOffset': 5, 'bpHeaderIx': 5, 'bnHeaderIx': 5, 'logRemoveFromList': 2, 'Unnecessary': 1, 'is': 1, 'Deprecated': 1, 'LlapDataBuffer': 1, 'getIsDirect': 1, 'getMinAllocation': 1, 'getMaxAllocation': 1, 'getArenaSize': 1, 'getMaxCacheSize': 1, 'methods': 2, 'step': 3, 'isInUse': 2, 'first': 2, 'second': 2, 'Debug': 1, 'test': 1, 'Race': 1, 'not': 1, 'disableDefragShortcutForTest': 1, 'setOomLoggingForTest': 1, 'b': 2, 'a': 4, 'string': 2, 'logError': 2, 'dumpTestLog': 1, 'casLog': 48, 'dumpLog': 2, 'debug': 1, 'enum': 1, 'log': 53, 'ERROR': 3, 'UNSET': 3, 'buddyHeaderIx': 2, 'addAndGet': 8, 'ordinal': 4, 'from': 3, 'to': 3, 'listIx': 4, 'dumpOneLine': 2, 'event': 3, 'switch': 1, 'case': 8, 'prefix': 9, 'toHexString': 2, 'default': 1, 'val': 2, 'values': 1, 'name': 1, 'l': 3, 'doSleep': 2, 'sleep': 1, 'logSize': 2}